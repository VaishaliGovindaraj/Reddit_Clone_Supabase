<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reddit Clone - Technical Documentation</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 20px;
            background: #f5f5f5;
        }

        .header {
            background: linear-gradient(135deg, #FF4500 0%, #FF5722 100%);
            color: white;
            padding: 60px 40px;
            border-radius: 12px;
            margin-bottom: 40px;
            box-shadow: 0 10px 30px rgba(255, 69, 0, 0.3);
        }

        .header h1 {
            font-size: 3em;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header p {
            font-size: 1.3em;
            opacity: 0.95;
        }

        .links {
            margin: 20px 0;
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
        }

        .links a {
            background: rgba(255,255,255,0.2);
            padding: 10px 20px;
            border-radius: 6px;
            color: white;
            text-decoration: none;
            font-weight: 500;
            transition: all 0.3s;
        }

        .links a:hover {
            background: rgba(255,255,255,0.3);
        }

        .section {
            background: white;
            padding: 40px;
            margin-bottom: 30px;
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.08);
        }

        h2 {
            color: #FF4500;
            font-size: 2em;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 3px solid #FF4500;
        }

        h3 {
            color: #2c3e50;
            font-size: 1.5em;
            margin-top: 30px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        h3::before {
            content: "â–¸";
            color: #FF4500;
            font-weight: bold;
        }

        h4 {
            color: #34495e;
            font-size: 1.2em;
            margin-top: 20px;
            margin-bottom: 10px;
            font-weight: 600;
        }

        code {
            background: #f8f9fa;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 0.9em;
            color: #e74c3c;
        }

        pre {
            background: #282c34;
            color: #abb2bf;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            margin: 15px 0;
            border-left: 4px solid #FF4500;
        }

        pre code {
            background: none;
            color: inherit;
            padding: 0;
            font-size: 0.95em;
        }

        .tech-stack {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 25px 0;
        }

        .tech-item {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid #FF4500;
            transition: transform 0.3s;
        }

        .tech-item:hover {
            transform: translateX(5px);
        }

        .tech-item strong {
            color: #FF4500;
            display: block;
            margin-bottom: 5px;
            font-size: 1.1em;
        }

        ul {
            margin: 15px 0 15px 30px;
        }

        li {
            margin: 10px 0;
            line-height: 1.8;
        }

        .file-path {
            background: #e8f4f8;
            padding: 8px 12px;
            border-radius: 6px;
            font-family: monospace;
            display: inline-block;
            margin: 5px 0;
            color: #2980b9;
            font-weight: 500;
        }

        .architecture-diagram {
            background: #f8f9fa;
            padding: 30px;
            border-radius: 8px;
            margin: 25px 0;
            text-align: center;
        }

        .feature-box {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 8px;
            margin: 20px 0;
        }

        .feature-box h4 {
            color: white;
            margin-top: 0;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }

        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }

        th {
            background: #FF4500;
            color: white;
            font-weight: 600;
        }

        tr:hover {
            background: #f8f9fa;
        }

        .warning-box {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 20px;
            margin: 20px 0;
            border-radius: 6px;
        }

        .info-box {
            background: #d1ecf1;
            border-left: 4px solid #0dcaf0;
            padding: 20px;
            margin: 20px 0;
            border-radius: 6px;
        }

        .page-break {
            page-break-after: always;
        }

        @media print {
            body {
                background: white;
            }
            .section {
                box-shadow: none;
                page-break-inside: avoid;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ğŸš€ Reddit Clone - Technical Documentation</h1>
        <p>A Full-Stack Reddit Clone Built with Next.js 16 & Supabase</p>
        <div class="links">
            <a href="https://github.com/VaishaliGovindaraj/Reddit_Clone_Supabase" target="_blank">ğŸ“¦ GitHub Repository</a>
            <a href="https://puzzle-game-vibe-coding.vercel.app/login" target="_blank">ğŸŒ Live Demo</a>
        </div>
    </div>

    <div class="section">
        <h2>ğŸ“‹ Table of Contents</h2>
        <ul>
            <li><a href="#overview">Project Overview</a></li>
            <li><a href="#tech-stack">Technology Stack</a></li>
            <li><a href="#architecture">Application Architecture</a></li>
            <li><a href="#authentication">Authentication System</a></li>
            <li><a href="#database">Database Integration</a></li>
            <li><a href="#features">Core Features & Implementation</a></li>
            <li><a href="#file-structure">File Structure</a></li>
            <li><a href="#important-code">Important Code Sections</a></li>
        </ul>
    </div>

    <div class="section" id="overview">
        <h2>ğŸ“– Project Overview</h2>
        <p>
            This is a feature-rich Reddit clone application built using modern web technologies.
            It implements core Reddit functionalities including user authentication, post creation,
            commenting, image uploads, and real-time search capabilities.
        </p>

        <div class="info-box">
            <strong>Project Type:</strong> Full-Stack Web Application<br>
            <strong>Framework:</strong> Next.js 16 with App Router<br>
            <strong>Backend:</strong> Supabase (PostgreSQL + Authentication + Storage)<br>
            <strong>Deployment:</strong> Vercel
        </div>

        <h3>Key Features</h3>
        <ul>
            <li><strong>User Authentication:</strong> Sign up, login, and logout with Supabase Auth</li>
            <li><strong>Post Management:</strong> Create, edit, and delete posts with optional images</li>
            <li><strong>Comment System:</strong> Add and delete comments on posts</li>
            <li><strong>Image Uploads:</strong> Upload images to Supabase Storage</li>
            <li><strong>Search Functionality:</strong> Real-time search for posts</li>
            <li><strong>Route Protection:</strong> Middleware-based authentication</li>
            <li><strong>Responsive Design:</strong> Tailwind CSS v4 for styling</li>
        </ul>
    </div>

    <div class="section page-break" id="tech-stack">
        <h2>ğŸ› ï¸ Technology Stack</h2>

        <div class="tech-stack">
            <div class="tech-item">
                <strong>Next.js 16</strong>
                React framework with App Router, Server Components, and Server Actions
            </div>
            <div class="tech-item">
                <strong>React 19</strong>
                Latest React with concurrent features
            </div>
            <div class="tech-item">
                <strong>TypeScript</strong>
                Type-safe development
            </div>
            <div class="tech-item">
                <strong>Supabase</strong>
                PostgreSQL database, authentication, and storage
            </div>
            <div class="tech-item">
                <strong>Tailwind CSS v4</strong>
                Utility-first CSS framework
            </div>
            <div class="tech-item">
                <strong>React Hook Form</strong>
                Form state management
            </div>
            <div class="tech-item">
                <strong>Zod</strong>
                Schema validation
            </div>
            <div class="tech-item">
                <strong>TanStack Query</strong>
                Data fetching and caching
            </div>
            <div class="tech-item">
                <strong>Sonner</strong>
                Toast notifications
            </div>
        </div>

        <h3>Package.json Dependencies</h3>
        <pre><code>{
  "dependencies": {
    "@hookform/resolvers": "^5.2.2",
    "@supabase/ssr": "^0.7.0",
    "@supabase/supabase-js": "^2.57.4",
    "@tanstack/react-query": "^5.89.0",
    "lucide-react": "^0.544.0",
    "next": "^16.0.10",
    "react": "^19.2.3",
    "react-dom": "^19.2.3",
    "react-hook-form": "^7.63.0",
    "sonner": "^2.0.7",
    "uuid": "^13.0.0",
    "zod": "^4.1.11"
  }
}</code></pre>
    </div>

    <div class="section page-break" id="architecture">
        <h2>ğŸ—ï¸ Application Architecture</h2>

        <div class="architecture-diagram">
            <h3>Three-Tier Architecture</h3>
            <pre>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           PRESENTATION LAYER (Client)           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚   Next.js App Router Components         â”‚   â”‚
â”‚  â”‚   - Pages & Layouts                     â”‚   â”‚
â”‚  â”‚   - Client Components                   â”‚   â”‚
â”‚  â”‚   - React Hook Form + Zod               â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â†•ï¸
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          APPLICATION LAYER (Server)             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚   Next.js Server Actions & Middleware   â”‚   â”‚
â”‚  â”‚   - Authentication Logic                â”‚   â”‚
â”‚  â”‚   - CRUD Operations                     â”‚   â”‚
â”‚  â”‚   - Route Protection                    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â†•ï¸
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            DATA LAYER (Supabase)                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  PostgreSQL   â”‚     Auth     â”‚  Storage  â”‚  â”‚
â”‚  â”‚   Database    â”‚    Service   â”‚  Bucket   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            </pre>
        </div>

        <h3>Data Flow</h3>
        <ol>
            <li><strong>User Action:</strong> User interacts with UI (form submission, button click)</li>
            <li><strong>Client Component:</strong> React Hook Form captures and validates data</li>
            <li><strong>Server Action:</strong> Next.js Server Action receives data</li>
            <li><strong>Validation:</strong> Zod schema validates input</li>
            <li><strong>Authentication:</strong> Supabase verifies user session</li>
            <li><strong>Database Operation:</strong> CRUD operation executed on Supabase</li>
            <li><strong>Revalidation:</strong> Next.js revalidates affected routes</li>
            <li><strong>UI Update:</strong> Client receives updated data and re-renders</li>
        </ol>
    </div>

    <div class="section page-break" id="authentication">
        <h2>ğŸ” Authentication System</h2>

        <h3>Overview</h3>
        <p>
            The application uses Supabase Authentication with custom middleware for route protection.
            It implements both server-side and client-side authentication flows.
        </p>

        <h3>1. Middleware for Route Protection</h3>
        <p class="file-path">src/middleware.ts</p>
        <pre><code>import { createServerClient } from "@supabase/ssr"
import { NextRequest, NextResponse } from "next/server"

export const middleware = async (request: NextRequest) => {
    let supabaseResponse = NextResponse.next({request})

    const supabase = createServerClient(
        process.env.NEXT_PUBLIC_SUPABASE_URL!,
        process.env.NEXT_PUBLIC_SUPABASE_PUBLISHABLE_KEY!,
        {
            cookies: {
                getAll(){
                    return request.cookies.getAll()
                },
                setAll(cookiesToSet){
                    cookiesToSet.forEach(({name,value})=>
                        request.cookies.set(name,value))
                    cookiesToSet.forEach(({name,value,options}) =>
                        supabaseResponse.cookies.set(name,value,options))
                }
            }
        }
    )

    const {data:{user}} = await supabase.auth.getUser()

    const protectedRoutes = [/^\/create\/?$/]

    if(!user && protectedRoutes.some(route =>
        route.test(request.nextUrl.pathname))) {
        const newUrl = request.nextUrl.clone()
        newUrl.pathname = "/auth/login"
        return NextResponse.redirect(newUrl)
    }

    return supabaseResponse
}</code></pre>

        <div class="feature-box">
            <h4>ğŸ”‘ How Middleware Works</h4>
            <ul>
                <li>Runs on every request before page rendering</li>
                <li>Creates Supabase client with cookie handling</li>
                <li>Checks if user is authenticated</li>
                <li>Protects routes like <code>/create</code></li>
                <li>Redirects unauthenticated users to login</li>
            </ul>
        </div>

        <h3>2. Supabase Client Configuration</h3>

        <h4>Server Client</h4>
        <p class="file-path">utils/supabase/server-client.ts</p>
        <pre><code>import { createServerClient } from "@supabase/ssr";
import { cookies } from "next/headers";

export const createClient = async () => {
    const cookieStore = await cookies();

    return createServerClient(
        process.env.NEXT_PUBLIC_SUPABASE_URL!,
        process.env.NEXT_PUBLIC_SUPABASE_PUBLISHABLE_KEY!,
        {
            cookies: {
                getAll() {
                    return cookieStore.getAll()
                },
                setAll(cookiesToSet) {
                    try {
                        cookiesToSet.forEach(({name,value,options}) => {
                            cookieStore.set(name,value,options)
                        })
                    } catch { }
                }
            }
        }
    )
}</code></pre>

        <h4>Browser Client</h4>
        <p class="file-path">utils/supabase/browserclient.ts</p>
        <pre><code>import { createBrowserClient } from "@supabase/ssr";

export const createClient = () => {
    return createBrowserClient(
        process.env.NEXT_PUBLIC_SUPABASE_URL!,
        process.env.NEXT_PUBLIC_SUPABASE_PUBLISHABLE_KEY!
    )
}</code></pre>

        <h3>3. Authentication Actions</h3>

        <h4>Sign Up Action</h4>
        <p class="file-path">src/actions/sign-up.ts</p>
        <pre><code>'use server'

export const SignUp = async (userdata: z.infer&lt;typeof signUpSchema&gt;) => {
    const supabase = await createClient()
    const {data:{user},error} = await supabase.auth.signUp(userdata)

    if(user && user.email){
        // Create user profile in database
        await supabase.from('users')
            .insert([{
                id: user.id,
                email: user.email,
                username: userdata.username
            }])
    }

    if(error) throw error
    redirect("/")
}</code></pre>

        <h4>Log In Action</h4>
        <p class="file-path">src/actions/log-in.ts</p>
        <pre><code>'use server'

export const LogIn = async(userData: z.infer&lt;typeof logInSchema&gt;) => {
    const parsedData = logInSchema.parse(userData)
    const supabase = await createClient()

    const {data:{user},error} = await supabase.auth
        .signInWithPassword(userData)

    if(error) throw error
    redirect("/")
}</code></pre>

        <h3>4. Validation Schemas</h3>
        <p class="file-path">src/actions/schema.ts</p>
        <pre><code>import z from "zod";

export const logInSchema = z.object({
    email: z.email(),
    password: z.string()
        .min(6,"Your password must be a minimum of 6 characters")
})

export const signUpSchema = z.object({
    email: z.email(),
    username: z.string()
        .regex(/^[a-zA-Z]+$/,"Username should contain only Letters"),
    password: z.string()
        .min(6,"Password must be minimum of 6 characters")
})</code></pre>
    </div>

    <div class="section page-break" id="database">
        <h2>ğŸ’¾ Database Integration</h2>

        <h3>Database Schema</h3>
        <p>The application uses three main tables in Supabase:</p>

        <table>
            <thead>
                <tr>
                    <th>Table</th>
                    <th>Purpose</th>
                    <th>Key Fields</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>users</strong></td>
                    <td>User profiles</td>
                    <td>id (UUID), email, username</td>
                </tr>
                <tr>
                    <td><strong>posts</strong></td>
                    <td>Post content</td>
                    <td>id, title, content, slug, user_id, image, created_at</td>
                </tr>
                <tr>
                    <td><strong>comments</strong></td>
                    <td>Post comments</td>
                    <td>id, comment_section, commentor_name, user_id, slug</td>
                </tr>
            </tbody>
        </table>

        <h3>Database Queries</h3>
        <p class="file-path">utils/supabase/queries.ts</p>

        <h4>Get Home Posts</h4>
        <pre><code>export const getHomePosts = async (supabase: ReturnType&lt;typeof createClient&gt;) => {
    return await supabase.from('posts')
        .select('id,title,slug,users("username"),image')
        .order('created_at',{ascending:false})
}</code></pre>

        <h4>Get Single Post with Comments</h4>
        <pre><code>export const getSinglePost = async (slug: string) => {
    const supabase = createClient()
    return await supabase.from('posts')
        .select(`
            id,title,content,slug,user_id,
            users("username"),
            image,
            comments("comment_section","commentor_name","slug","user_id",id)
        `)
        .eq('slug',slug)
        .single()
}</code></pre>

        <h4>Search Posts</h4>
        <pre><code>export const getSearchPost = async (searchTerm: string) => {
    const supabase = createClient()
    return await supabase.from('posts')
        .select('title,slug')
        .ilike('title',`${searchTerm}%`)
}</code></pre>

        <div class="info-box">
            <strong>ğŸ’¡ Key Features:</strong>
            <ul>
                <li>Type-safe queries with TypeScript</li>
                <li>Automatic joins with foreign key relationships</li>
                <li>Real-time search with <code>ilike</code></li>
                <li>Sorted by creation date</li>
            </ul>
        </div>
    </div>

    <div class="section page-break" id="features">
        <h2>âœ¨ Core Features & Implementation</h2>

        <h3>1. Post Management</h3>

        <h4>Create Post Action</h4>
        <p class="file-path">src/actions/create-post.ts</p>
        <pre><code>'use server'

export const CreatePost = async (userdata: z.infer&lt;typeof postSchema&gt;) => {
    const parsedData = postSchema.parse(userdata)
    const slug = slugify(parsedData.title)

    // Handle image upload
    const imageFile = userdata.image?.get("image")
    if(!(imageFile instanceof File) && imageFile !== null) {
        throw new Error("malformed image File")
    }

    const publicImageUrl = imageFile instanceof File
        ? await uploadImage(imageFile)
        : null

    // Verify authentication
    const supabase = await createClient()
    const {data:{user}} = await supabase.auth.getUser();
    if(!user) throw new Error("Not Authorized")

    // Insert post
    await supabase.from('posts')
        .insert([{
            user_id: userId,
            slug: slug,
            ...parsedData,
            image: publicImageUrl
        }])
        .throwOnError()

    revalidatePath("/")
    redirect(`/${slug}`)
}</code></pre>

        <h4>Slug Generation</h4>
        <p class="file-path">utils/slugify.ts</p>
        <pre><code>export const slugify = (text: string) => {
    return text
        .toLowerCase()
        .trim()
        .replace(/[^\w\s-]/g,'')
        .replace(/[\s_]/g,'-')
        .replace(/-+/g,'-')
}</code></pre>

        <div class="feature-box">
            <h4>ğŸ“ Post Creation Flow</h4>
            <ol>
                <li>User submits form with title, content, and optional image</li>
                <li>Data validated with Zod schema</li>
                <li>Title converted to URL-friendly slug</li>
                <li>Image uploaded to Supabase Storage (if provided)</li>
                <li>Post inserted into database</li>
                <li>Homepage revalidated</li>
                <li>User redirected to new post</li>
            </ol>
        </div>

        <h3>2. Image Upload System</h3>
        <p class="file-path">utils/supabase/upload-image.ts</p>
        <pre><code>import { v4 as uuid } from 'uuid';

export const uploadImage = async (image: File) => {
    const supabase = await createClient();

    // Generate unique filename
    const imageName: string[] = image.name.split('.')
    const path: string = `${imageName[0]}-${uuid()}.${imageName[1]}`

    // Upload to Supabase Storage
    const {data,error} = await supabase.storage
        .from('images')
        .upload(path, image)

    if(error) throw error

    // Get public URL
    const {data:{publicUrl}} = await supabase.storage
        .from('images')
        .getPublicUrl(data.path);

    return publicUrl
}</code></pre>

        <h3>3. Comment System</h3>
        <p class="file-path">src/actions/create-comment.ts</p>
        <pre><code>'use server'

export const CreateComment = async ({
    comment_section,
    slug,
    id
}: {
    comment_section: string,
    id: number,
    slug: string
}) => {
    try {
        const parsedData = commentSchema.parse({ comment_section })
        const supabase = await createClient()
        const { data: { user } } = await supabase.auth.getUser()

        if (!user) throw new Error("Not Authorized")

        // Fetch user profile
        const { data: profile } = await supabase
            .from("users")
            .select("username,id")
            .eq("id", user.id)
            .single()

        // Insert comment
        await supabase
            .from("comments")
            .insert([{
                slug,
                comment_section: parsedData.comment_section,
                commentor_name: profile?.username || "Anonymous",
                user_id: profile?.id || "Anonymous"
            }])
            .throwOnError()

        revalidatePath(`/${slug}`)
    } catch (err) {
        console.error("ERROR IN CreateComment:", err)
        throw err
    }
}</code></pre>

        <h3>4. Search Functionality</h3>
        <p>Real-time search implemented with TanStack Query for efficient data fetching and caching.</p>
        <p class="file-path">src/components/Search/index.tsx</p>
        <ul>
            <li>Debounced search input</li>
            <li>Case-insensitive partial matching</li>
            <li>Instant results dropdown</li>
            <li>Navigation to post on selection</li>
        </ul>
    </div>

    <div class="section page-break" id="file-structure">
        <h2>ğŸ“ File Structure</h2>

        <pre><code>Reddit_Clone_Supabase/
â”‚
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ actions/              # Server Actions
â”‚   â”‚   â”œâ”€â”€ create-comment.ts
â”‚   â”‚   â”œâ”€â”€ create-post.ts
â”‚   â”‚   â”œâ”€â”€ delete-comments.ts
â”‚   â”‚   â”œâ”€â”€ delete-post.ts
â”‚   â”‚   â”œâ”€â”€ edit-posts.ts
â”‚   â”‚   â”œâ”€â”€ log-in.ts
â”‚   â”‚   â”œâ”€â”€ log-out.ts
â”‚   â”‚   â”œâ”€â”€ sign-up.ts
â”‚   â”‚   â””â”€â”€ schema.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ app/                  # Next.js App Router
â”‚   â”‚   â”œâ”€â”€ (main)/
â”‚   â”‚   â”‚   â”œâ”€â”€ [slug]/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ edit/
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ EditForm/
â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ page.tsx
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ DeleteButton/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ EditButton/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ page.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ create/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ page.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ layout.tsx
â”‚   â”‚   â”‚   â””â”€â”€ page.tsx
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ auth/
â”‚   â”‚   â”‚   â”œâ”€â”€ login/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ LoginForm/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ page.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ signup/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ SignupForm/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ page.tsx
â”‚   â”‚   â”‚   â””â”€â”€ layout.tsx
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ layout.tsx
â”‚   â”‚   â””â”€â”€ globals.css
â”‚   â”‚
â”‚   â”œâ”€â”€ components/           # React Components
â”‚   â”‚   â”œâ”€â”€ AccountLinks/
â”‚   â”‚   â”œâ”€â”€ Header/
â”‚   â”‚   â”œâ”€â”€ LogOut/
â”‚   â”‚   â”œâ”€â”€ Logo/
â”‚   â”‚   â”œâ”€â”€ Search/
â”‚   â”‚   â”œâ”€â”€ comments/
â”‚   â”‚   â”‚   â”œâ”€â”€ CommentSection/
â”‚   â”‚   â”‚   â””â”€â”€ index.tsx
â”‚   â”‚   â””â”€â”€ Home/
â”‚   â”‚
â”‚   â””â”€â”€ middleware.ts         # Route Protection
â”‚
â”œâ”€â”€ utils/
â”‚   â”œâ”€â”€ supabase/
â”‚   â”‚   â”œâ”€â”€ browserclient.ts
â”‚   â”‚   â”œâ”€â”€ server-client.ts
â”‚   â”‚   â”œâ”€â”€ queries.ts
â”‚   â”‚   â”œâ”€â”€ upload-image.ts
â”‚   â”‚   â””â”€â”€ datatypes.types.ts
â”‚   â””â”€â”€ slugify.ts
â”‚
â”œâ”€â”€ providers/
â”‚   â””â”€â”€ query-client-provider.tsx
â”‚
â”œâ”€â”€ public/                   # Static Assets
â”œâ”€â”€ package.json
â”œâ”€â”€ tailwind.config.ts
â”œâ”€â”€ tsconfig.json
â””â”€â”€ next.config.ts
</code></pre>
    </div>

    <div class="section page-break" id="important-code">
        <h2>ğŸ”¥ Important Code Sections</h2>

        <h3>1. App Layout with Query Provider</h3>
        <p class="file-path">src/app/layout.tsx</p>
        <pre><code>import { QueryClientProvider } from "../../providers/query-client-provider";
import { Toaster } from "sonner";

export default function RootLayout({
    children,
}: Readonly&lt;{ children: React.ReactNode }&gt;) {
    return (
        &lt;html lang="en"&gt;
            &lt;body className="p-4 pt-6 antialiased font-sans"&gt;
                &lt;Toaster richColors/&gt;
                &lt;QueryClientProvider&gt;
                    {children}
                &lt;/QueryClientProvider&gt;
            &lt;/body&gt;
        &lt;/html&gt;
    );
}</code></pre>

        <h3>2. Home Page Server Component</h3>
        <p class="file-path">src/app/(main)/page.tsx</p>
        <pre><code>import { getHomePosts } from "../../../utils/supabase/queries";

export const revalidate = 60; // Revalidate every 60 seconds

export default async function Home() {
    const supabase = await createClient();
    const {data, error} = await getHomePosts(supabase)

    return (
        &lt;div&gt;
            {data && &lt;HomePosts posts={data} /&gt;}
        &lt;/div&gt;
    );
}</code></pre>

        <h3>3. Single Post Page with Comments</h3>
        <p class="file-path">src/app/(main)/[slug]/page.tsx</p>
        <pre><code>const singlePost = async ({params}:{params:{slug:string}}) => {
    const {slug} = await params
    const {data, error} = await getSinglePost(slug)
    const supabase = await createClient();
    const {data:{user}} = await supabase.auth.getUser();

    const isAuthor = user?.id === data?.user_id

    return (
        &lt;div className="container-narrow"&gt;
            {/* Post Header */}
            &lt;div className="card"&gt;
                &lt;h1&gt;{data.title}&lt;/h1&gt;
                &lt;p&gt;{data.users?.username}&lt;/p&gt;
            &lt;/div&gt;

            {/* Post Image */}
            {data?.image && &lt;img src={data.image} alt={data.title} /&gt;}

            {/* Post Content */}
            &lt;div className="card"&gt;{data.content}&lt;/div&gt;

            {/* Author Actions */}
            {isAuthor && (
                &lt;&gt;
                    &lt;EditButton slug={slug}/&gt;
                    &lt;DeleteButton postId={data.id}/&gt;
                &lt;/&gt;
            )}

            {/* Comments */}
            {user && &lt;CommentSection slug={slug} id={data.id}/&gt;}
            {data.comments && (
                &lt;Comments
                    comments={data.comments}
                    currentUserId={user?.id}
                    postAuthorId={data.user_id}
                    slug={slug}
                /&gt;
            )}
        &lt;/div&gt;
    )
}</code></pre>

        <h3>4. Header Component</h3>
        <p class="file-path">src/components/Header/index.tsx</p>
        <pre><code>const Header = () => {
    return(
        &lt;header className="header-nav"&gt;
            &lt;div className="container-main py-4"&gt;
                &lt;div className="flex items-center justify-between gap-6"&gt;
                    &lt;Logo /&gt;
                    &lt;div className="flex-1 max-w-2xl"&gt;
                        &lt;SearchInput /&gt;
                    &lt;/div&gt;
                    &lt;AccountLinks /&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/header&gt;
    )
}</code></pre>

        <h3>5. Validation Schemas</h3>
        <p class="file-path">src/actions/schema.ts</p>
        <pre><code>export const postSchema = z.object({
    title: z.string().min(3,"Title must have 3 characters"),
    content: z.string().optional(),
    image: z.instanceof(FormData).optional(),
})

export const commentSchema = z.object({
    comment_section: z.string().min(1, "Comment cannot be empty"),
})</code></pre>
    </div>

    <div class="section page-break">
        <h2>ğŸš€ Deployment & Environment</h2>

        <h3>Environment Variables Required</h3>
        <pre><code>NEXT_PUBLIC_SUPABASE_URL=your_supabase_project_url
NEXT_PUBLIC_SUPABASE_PUBLISHABLE_KEY=your_supabase_anon_key</code></pre>

        <h3>Build Configuration</h3>
        <p class="file-path">package.json</p>
        <pre><code>{
  "scripts": {
    "dev": "next dev --turbopack",
    "build": "next build --turbopack",
    "start": "next start"
  }
}</code></pre>

        <div class="info-box">
            <strong>Deployment Platform:</strong> Vercel<br>
            <strong>Live URL:</strong> <a href="https://puzzle-game-vibe-coding.vercel.app/login">https://puzzle-game-vibe-coding.vercel.app/login</a><br>
            <strong>Build Tool:</strong> Turbopack (Next.js 16 default)
        </div>

        <h3>Key Deployment Features</h3>
        <ul>
            <li><strong>Automatic Deployments:</strong> Push to main triggers deployment</li>
            <li><strong>Edge Runtime:</strong> Middleware runs on edge for low latency</li>
            <li><strong>ISR:</strong> Pages revalidate every 60 seconds</li>
            <li><strong>Environment Variables:</strong> Configured in Vercel dashboard</li>
        </ul>
    </div>

    <div class="section page-break">
        <h2>ğŸ”’ Security Considerations</h2>

        <h3>Implemented Security Measures</h3>

        <div class="feature-box">
            <h4>1. Authentication & Authorization</h4>
            <ul>
                <li>JWT-based authentication via Supabase</li>
                <li>Middleware-level route protection</li>
                <li>Server-side user verification for all mutations</li>
                <li>Author-only edit/delete permissions</li>
            </ul>
        </div>

        <div class="feature-box">
            <h4>2. Data Validation</h4>
            <ul>
                <li>Zod schemas for all user inputs</li>
                <li>Type-safe database queries with TypeScript</li>
                <li>File type validation for image uploads</li>
                <li>SQL injection prevention via Supabase client</li>
            </ul>
        </div>

        <div class="feature-box">
            <h4>3. Secure File Uploads</h4>
            <ul>
                <li>UUID-based unique filenames</li>
                <li>Stored in Supabase Storage bucket</li>
                <li>File type checking before upload</li>
                <li>Public URL generation after successful upload</li>
            </ul>
        </div>

        <h3>Best Practices Followed</h3>
        <ul>
            <li>Environment variables for sensitive data</li>
            <li>Server-side rendering for sensitive operations</li>
            <li>HTTPS enforced on Vercel</li>
            <li>Row-level security policies in Supabase</li>
            <li>Error handling without exposing stack traces</li>
        </ul>
    </div>

    <div class="section page-break">
        <h2>ğŸ“Š Performance Optimizations</h2>

        <h3>Next.js 16 Features Utilized</h3>
        <ul>
            <li><strong>Turbopack:</strong> Faster builds and hot module replacement</li>
            <li><strong>React Server Components:</strong> Reduced client-side JavaScript</li>
            <li><strong>Server Actions:</strong> Direct server mutations without API routes</li>
            <li><strong>Incremental Static Regeneration:</strong> 60-second revalidation</li>
            <li><strong>Automatic Image Optimization:</strong> Next.js Image component</li>
        </ul>

        <h3>Database Optimizations</h3>
        <ul>
            <li>Efficient queries with selective field selection</li>
            <li>Database indexing on frequently queried fields (slug, created_at)</li>
            <li>Single query for posts with user data (joins)</li>
            <li>TanStack Query for client-side caching</li>
        </ul>

        <h3>Frontend Optimizations</h3>
        <ul>
            <li>Tailwind CSS for minimal CSS bundle size</li>
            <li>Code splitting via Next.js App Router</li>
            <li>Debounced search input</li>
            <li>Toast notifications via lightweight Sonner library</li>
        </ul>
    </div>

    <div class="section page-break">
        <h2>ğŸ¯ Key Takeaways</h2>

        <h3>Architecture Highlights</h3>
        <div class="tech-stack">
            <div class="tech-item">
                <strong>Modern Stack</strong>
                Using latest versions of Next.js 16, React 19, and Tailwind CSS v4
            </div>
            <div class="tech-item">
                <strong>Type Safety</strong>
                Full TypeScript coverage with Zod validation
            </div>
            <div class="tech-item">
                <strong>Scalable Backend</strong>
                Supabase provides production-ready PostgreSQL, auth, and storage
            </div>
            <div class="tech-item">
                <strong>DX Optimized</strong>
                Turbopack for fast builds, Server Actions for simple mutations
            </div>
        </div>

        <h3>Code Quality Features</h3>
        <ul>
            <li>âœ… Consistent error handling with try-catch</li>
            <li>âœ… Proper TypeScript types throughout</li>
            <li>âœ… Reusable server actions</li>
            <li>âœ… Clean separation of concerns (actions, queries, components)</li>
            <li>âœ… Path revalidation after mutations</li>
            <li>âœ… Form validation with React Hook Form + Zod</li>
        </ul>

        <h3>Production Readiness</h3>
        <div class="feature-box">
            <h4>âœ… Ready for Production</h4>
            <ul>
                <li>Deployed on Vercel with HTTPS</li>
                <li>Environment variables configured</li>
                <li>Database hosted on Supabase cloud</li>
                <li>Authentication fully implemented</li>
                <li>Error boundaries and loading states</li>
                <li>Mobile-responsive design</li>
            </ul>
        </div>
    </div>

    <div class="section">
        <h2>ğŸ“š Additional Resources</h2>

        <h3>Official Documentation</h3>
        <ul>
            <li><strong>Next.js 16:</strong> <a href="https://nextjs.org/docs">https://nextjs.org/docs</a></li>
            <li><strong>Supabase:</strong> <a href="https://supabase.com/docs">https://supabase.com/docs</a></li>
            <li><strong>Tailwind CSS v4:</strong> <a href="https://tailwindcss.com/docs">https://tailwindcss.com/docs</a></li>
            <li><strong>React Hook Form:</strong> <a href="https://react-hook-form.com">https://react-hook-form.com</a></li>
            <li><strong>Zod:</strong> <a href="https://zod.dev">https://zod.dev</a></li>
        </ul>

        <h3>Project Links</h3>
        <ul>
            <li><strong>GitHub Repository:</strong> <a href="https://github.com/VaishaliGovindaraj/Reddit_Clone_Supabase">https://github.com/VaishaliGovindaraj/Reddit_Clone_Supabase</a></li>
            <li><strong>Live Demo:</strong> <a href="https://puzzle-game-vibe-coding.vercel.app/login">https://puzzle-game-vibe-coding.vercel.app/login</a></li>
        </ul>

        <div class="info-box">
            <strong>ğŸ“… Document Generated:</strong> December 2025<br>
            <strong>ğŸ‘¤ Project Owner:</strong> VaishaliGovindaraj<br>
            <strong>ğŸ·ï¸ Version:</strong> 0.1.0
        </div>
    </div>

    <footer style="text-align: center; padding: 40px; color: #666; border-top: 2px solid #eee; margin-top: 40px;">
        <p style="font-size: 1.2em; margin-bottom: 10px;">End of Documentation</p>
        <p>Reddit Clone - Technical Documentation</p>
        <p>Generated with â¤ï¸ for developers</p>
    </footer>
</body>
</html>
